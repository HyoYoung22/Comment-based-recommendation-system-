{"cells":[{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3401,"status":"ok","timestamp":1693336109568,"user":{"displayName":"장효영","userId":"03421268139272049983"},"user_tz":-540},"id":"wASMlvg-Qfn8","outputId":"47293b39-2b88-4f8d-bee2-8a701f1d4d17"},"outputs":[],"source":["import pandas as pd\n","from sklearn.feature_extraction.text import CountVectorizer\n","from sklearn.feature_extraction.text import TfidfVectorizer\n","from sklearn.metrics.pairwise import cosine_similarity\n","from collections import defaultdict"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":853,"status":"ok","timestamp":1693336133551,"user":{"displayName":"장효영","userId":"03421268139272049983"},"user_tz":-540},"id":"uBfp2DFLQlGa","outputId":"7bf824df-2dc5-43e6-c1ab-895cd0aa324d"},"outputs":[{"name":"stdout","output_type":"stream","text":["545.0\n"]}],"source":["rev_data  = pd.read_csv('./game_info_keywords.csv')\n","\n","m = rev_data['review_num'].quantile(0.0)\n","print(m)\n","rev_data = rev_data.loc[rev_data['review_num'] >= m]\n","\n","c = rev_data['rating'].mean()\n","\n","def weight_rating(x,m=m, c=c):\n","    v = x['review_num']\n","    r = x['rating']\n","\n","    return (v / (v+m)*r)+(m/(v+m) * c)\n","\n","rev_data['score'] = rev_data.apply(weight_rating, axis = 1)\n","\n","counter_vector = CountVectorizer(ngram_range = (1,3))\n","tfidf = TfidfVectorizer(stop_words='english')\n","\n","tfidf_matrix_keys = tfidf.fit_transform(rev_data['key_words'])\n","c_vector_keys = counter_vector.fit_transform(rev_data['key_words'])\n","\n","tfidf_matrix_genres = tfidf.fit_transform(rev_data['genre'])\n","c_vector_genres = counter_vector.fit_transform(rev_data['genre'])\n","\n","\n","similarity_genre_c = cosine_similarity(c_vector_genres, c_vector_genres).argsort()[:,::-1]\n","similarity_genre_t = cosine_similarity(tfidf_matrix_genres, tfidf_matrix_genres).argsort()[:,::-1]\n","\n","similarity_key_c = cosine_similarity(c_vector_keys, c_vector_keys).argsort()[:,::-1]\n","similarity_key_t = cosine_similarity(tfidf_matrix_keys, tfidf_matrix_keys).argsort()[:,::-1]\n","\n","def recommend_movie_list_gc(rev_data, movie_title, top = 7):\n","    target_movie_index = rev_data[rev_data['Unnamed: 0'] == movie_title].index.values\n","\n","    sim_index = similarity_genre_c[target_movie_index, :top].reshape(-1)\n","\n","    sim_index = sim_index[sim_index != target_movie_index]\n","\n","    result = rev_data.iloc[sim_index].sort_values('score', ascending = False)[:5]\n","\n","    return result\n","\n","def recommend_movie_list_gt(rev_data, movie_title, top = 7):\n","    target_movie_index = rev_data[rev_data['Unnamed: 0'] == movie_title].index.values\n","\n","    sim_index = similarity_genre_t[target_movie_index, :top].reshape(-1)\n","\n","    sim_index = sim_index[sim_index != target_movie_index]\n","\n","    result = rev_data.iloc[sim_index].sort_values('score', ascending = False)[:5]\n","\n","    return result\n","\n","def recommend_movie_list_kc(rev_data, movie_title, top = 7):\n","    target_movie_index = rev_data[rev_data['Unnamed: 0'] == movie_title].index.values\n","\n","    sim_index = similarity_key_c[target_movie_index, :top].reshape(-1)\n","\n","    sim_index = sim_index[sim_index != target_movie_index]\n","\n","    result = rev_data.iloc[sim_index].sort_values('score', ascending = False)[:5]\n","\n","    return result\n","\n","def recommend_movie_list_kt(rev_data, movie_title, top = 7):\n","    target_movie_index = rev_data[rev_data['Unnamed: 0'] == movie_title].index.values\n","\n","    sim_index = similarity_key_t[target_movie_index, :top].reshape(-1)\n","\n","    sim_index = sim_index[sim_index != target_movie_index]\n","\n","    result = rev_data.iloc[sim_index].sort_values('score', ascending = False)[:5]\n","\n","    return result"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":678},"executionInfo":{"elapsed":589,"status":"ok","timestamp":1693336134538,"user":{"displayName":"장효영","userId":"03421268139272049983"},"user_tz":-540},"id":"OTf6fWx9QubN","outputId":"46965ee7-ebbd-496f-a987-d85b2ec6255d"},"outputs":[],"source":["# recommend_movie_list_gc(rev_data, movie_title = '오목')"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":660},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1693336134539,"user":{"displayName":"장효영","userId":"03421268139272049983"},"user_tz":-540},"id":"n6E6n-gqQw2G","outputId":"5ec6b9c8-1294-40c1-b73d-c7a9f999ee1f"},"outputs":[],"source":["# recommend_movie_list_gt(rev_data, movie_title = '메이플스토리M')"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":678},"executionInfo":{"elapsed":535,"status":"ok","timestamp":1693336176851,"user":{"displayName":"장효영","userId":"03421268139272049983"},"user_tz":-540},"id":"zmtLHX_FQ5DF","outputId":"448ae4a9-af5a-4742-99b9-da8289854c9e"},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Unnamed: 0</th>\n","      <th>genre</th>\n","      <th>rating</th>\n","      <th>review_num</th>\n","      <th>url</th>\n","      <th>img</th>\n","      <th>key_words</th>\n","      <th>score</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>86</th>\n","      <td>애니팡</td>\n","      <td>puzzle</td>\n","      <td>4.0</td>\n","      <td>201000</td>\n","      <td>https://play.google.com/store/apps/details?id=...</td>\n","      <td>https://play-lh.googleusercontent.com/Ens0TL2o...</td>\n","      <td>['애니팡', '토파즈', '광고', '삭제', '아이템', '접속', '설치', ...</td>\n","      <td>3.999614</td>\n","    </tr>\n","    <tr>\n","      <th>56</th>\n","      <td>애니팡 맞고</td>\n","      <td>board</td>\n","      <td>3.9</td>\n","      <td>128000</td>\n","      <td>https://play.google.com/store/apps/details?id=...</td>\n","      <td>https://play-lh.googleusercontent.com/mnKXlP-7...</td>\n","      <td>['오링', '올인', '광고', '애니팡', '삭제', '몰아주기', '짜증', ...</td>\n","      <td>3.899818</td>\n","    </tr>\n","    <tr>\n","      <th>85</th>\n","      <td>애니팡 사천성</td>\n","      <td>puzzle</td>\n","      <td>3.8</td>\n","      <td>355000</td>\n","      <td>https://play.google.com/store/apps/details?id=...</td>\n","      <td>https://play-lh.googleusercontent.com/dP2SFJpV...</td>\n","      <td>['광고', '사천성', '딸기', '업데이트', '접속', '오션', '페리', ...</td>\n","      <td>3.800088</td>\n","    </tr>\n","    <tr>\n","      <th>55</th>\n","      <td>바둑2.0</td>\n","      <td>board</td>\n","      <td>3.5</td>\n","      <td>1140</td>\n","      <td>https://play.google.com/store/apps/details?id=...</td>\n","      <td>https://play-lh.googleusercontent.com/Uv7RDIyA...</td>\n","      <td>['바둑', '계가', '대국', '형세', '초읽기', '급수', '타이젬', '...</td>\n","      <td>3.615515</td>\n","    </tr>\n","    <tr>\n","      <th>77</th>\n","      <td>프렌즈사천성</td>\n","      <td>puzzle</td>\n","      <td>3.6</td>\n","      <td>110000</td>\n","      <td>https://play.google.com/store/apps/details?id=...</td>\n","      <td>https://playgame-img.kakaogames.com/production...</td>\n","      <td>['오류', '하트', '사천성', '인터넷', '접속', '시간', '광고', '...</td>\n","      <td>3.601268</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   Unnamed: 0   genre  rating  review_num  \\\n","86        애니팡  puzzle     4.0      201000   \n","56     애니팡 맞고   board     3.9      128000   \n","85    애니팡 사천성  puzzle     3.8      355000   \n","55      바둑2.0   board     3.5        1140   \n","77     프렌즈사천성  puzzle     3.6      110000   \n","\n","                                                  url  \\\n","86  https://play.google.com/store/apps/details?id=...   \n","56  https://play.google.com/store/apps/details?id=...   \n","85  https://play.google.com/store/apps/details?id=...   \n","55  https://play.google.com/store/apps/details?id=...   \n","77  https://play.google.com/store/apps/details?id=...   \n","\n","                                                  img  \\\n","86  https://play-lh.googleusercontent.com/Ens0TL2o...   \n","56  https://play-lh.googleusercontent.com/mnKXlP-7...   \n","85  https://play-lh.googleusercontent.com/dP2SFJpV...   \n","55  https://play-lh.googleusercontent.com/Uv7RDIyA...   \n","77  https://playgame-img.kakaogames.com/production...   \n","\n","                                            key_words     score  \n","86  ['애니팡', '토파즈', '광고', '삭제', '아이템', '접속', '설치', ...  3.999614  \n","56  ['오링', '올인', '광고', '애니팡', '삭제', '몰아주기', '짜증', ...  3.899818  \n","85  ['광고', '사천성', '딸기', '업데이트', '접속', '오션', '페리', ...  3.800088  \n","55  ['바둑', '계가', '대국', '형세', '초읽기', '급수', '타이젬', '...  3.615515  \n","77  ['오류', '하트', '사천성', '인터넷', '접속', '시간', '광고', '...  3.601268  "]},"execution_count":22,"metadata":{},"output_type":"execute_result"}],"source":["recommend_movie_list_kc(rev_data, movie_title = '오목')"]},{"cell_type":"code","execution_count":27,"metadata":{},"outputs":[],"source":["d = defaultdict(int)"]},{"cell_type":"code","execution_count":36,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":678},"executionInfo":{"elapsed":383,"status":"ok","timestamp":1693336135448,"user":{"displayName":"장효영","userId":"03421268139272049983"},"user_tz":-540},"id":"gOgfdJ9UQ9W8","outputId":"15288cdd-a32d-46d2-fe9e-8d27f0a3d683"},"outputs":[],"source":["a = recommend_movie_list_kt(rev_data, movie_title = '애니팡')\n","a = a[['Unnamed: 0','score']]\n","for i in range(len(a)):\n","    d[a.iloc[i][0]] += a.iloc[i][1]\n"]},{"cell_type":"code","execution_count":37,"metadata":{"id":"4KXIQWUMgDsO"},"outputs":[{"name":"stdout","output_type":"stream","text":["defaultdict(<class 'int'>, {'애니팡': 3.9996136984650716, '애니팡 맞고': 19.499091479915315, '애니팡 사천성': 3.8000875918860983, '바둑2.0': 3.6155150487494705, '프렌즈사천성': 3.6012677448744213, '스누피 틀린그림찾기': 16.387006293497887, '애니팡2': 15.999688741064691, '프렌즈팝': 15.998072186874069, '애니팡3': 15.200615030874973})\n"]}],"source":["print(d)"]},{"cell_type":"code","execution_count":38,"metadata":{},"outputs":[],"source":["d = defaultdict(int)\n","for i in range(5):\n","    "]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]}],"metadata":{"colab":{"authorship_tag":"ABX9TyOyqTJsJaWrPLVEiEY3itW5","provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.13"}},"nbformat":4,"nbformat_minor":0}
